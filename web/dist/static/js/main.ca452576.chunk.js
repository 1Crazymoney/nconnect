(this["webpackJsonpnkn-socks-web"]=this["webpackJsonpnkn-socks-web"]||[]).push([[0],{114:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),s=n.n(c),i=(n(69),n(70),n(10)),d=n.n(i),o=n(14),u=n(52),l=n(53),p=n(23),h=n(57),m=n(58),f=n(54),v=n.n(f),A=n(153),b=n(148),k=n(152),g=n(55),y=n.n(g);var w="/rpc/admin",j={getAdminToken:{method:"getAdminToken"},getAddrs:{method:"getAddrs"},setAddrs:{method:"setAddrs"},addAddrs:{method:"addAddrs"},removeAddrs:{method:"removeAddrs"},getLocalIP:{method:"getLocalIP"}},O={},x=function(e){j.hasOwnProperty(e)&&(O[e]=function(t,n){return n=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];for(var r=0,c=n;r<c.length;r++){var s=c[r];if(s)for(var i=0,d=Object.keys(s);i<d.length;i++){var o=d[i];void 0!==s[o]&&(e[o]=s[o])}}return e}({},j[e].defaultParams,n),function(e,t){return E.apply(this,arguments)}(t,j[e].method,n)})};for(var S in j)x(S);function E(){return(E=Object(o.a)(d.a.mark((function e(t,n){var a,r,c,s=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:{},e.next=3,y()({url:t,method:"POST",timeout:1e4,data:{id:"nkn-socks-web",jsonrpc:"2.0",method:n,params:a}});case 3:if(r=e.sent,!(c=r.data).error){e.next=7;break}throw c.error;case 7:if(void 0===c.result){e.next=9;break}return e.abrupt("return",c.result);case 9:throw"rpc response contains no result or error field";case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return T.apply(this,arguments)}function T(){return(T=Object(o.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.getAdminToken(w));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(o.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.getAddrs(w));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t){return L.apply(this,arguments)}function L(){return(L=Object(o.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},t&&(a.acceptAddrs=t),n&&(a.adminAddrs=n),e.abrupt("return",O.setAddrs(w,a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return(R=Object(o.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.getLocalIP(w));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(114);function D(e){return e?e.join("\n"):""}function J(e){return e?e.split("\n").filter((function(e){return e.length>0})):[]}var Q=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={adminTokenStr:"",adminTokenQRCode:"",acceptAddrs:"",adminAddrs:"",localIP:[]},a.handleAcceptAddrsChange=a.handleAcceptAddrsChange.bind(Object(p.a)(a)),a.handleAdminAddrsChange=a.handleAdminAddrsChange.bind(Object(p.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(p.a)(a)),a.updateAdminToken=a.updateAdminToken.bind(Object(p.a)(a)),a}return Object(l.a)(n,[{key:"handleAcceptAddrsChange",value:function(e){this.setState({acceptAddrs:e.target.value})}},{key:"handleAdminAddrsChange",value:function(e){this.setState({adminAddrs:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(o.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,I(J(this.state.acceptAddrs),J(this.state.adminAddrs));case 4:n=e.sent,this.setState({acceptAddrs:D(n.acceptAddrs),adminAddrs:D(n.adminAddrs)}),alert("Save success!"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),alert(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAdminToken",value:function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C();case 3:if(!(t=e.sent)){e.next=10;break}return n=JSON.stringify(t),e.next=8,v.a.toDataURL(n);case 8:a=e.sent,this.setState({adminTokenStr:n,adminTokenQRCode:a});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;this.updateAdminToken(),setInterval(this.updateAdminToken,3e5),function(){return P.apply(this,arguments)}().then((function(t){e.setState({acceptAddrs:D(t.acceptAddrs),adminAddrs:D(t.adminAddrs)})})).catch((function(e){console.error(e),alert(e)})),function(){return R.apply(this,arguments)}().then((function(t){e.setState({localIP:t.ipv4})})).catch((function(e){console.error(e)}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(b.a,null,r.a.createElement("div",null,r.a.createElement("img",{src:this.state.adminTokenQRCode})),r.a.createElement("div",null,r.a.createElement(k.a,{disabled:!0,multiline:!0,label:"Local IP address",value:this.state.localIP.join("\n")})),r.a.createElement("div",null,r.a.createElement(k.a,{disabled:!0,multiline:!0,label:"Access key (expires in 5 minutes)",value:this.state.adminTokenStr,style:{width:"100%"}})),r.a.createElement("div",null,r.a.createElement(k.a,{multiline:!0,variant:"filled",label:"Accept addresses",value:this.state.acceptAddrs,onChange:this.handleAcceptAddrsChange,style:{width:"100%"}})),r.a.createElement("div",null,r.a.createElement(k.a,{multiline:!0,variant:"filled",label:"Admins",value:this.state.adminAddrs,onChange:this.handleAdminAddrsChange,style:{width:"100%"}})),r.a.createElement("div",null,r.a.createElement(A.a,{variant:"contained",color:"primary",onClick:this.handleSubmit},"Save"))))}}]),n}(r.a.Component);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null)),document.getElementById("root"))},64:function(e,t,n){e.exports=n(118)},70:function(e,t,n){}},[[64,1,2]]]);
//# sourceMappingURL=main.ca452576.chunk.js.map